<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="title">ComfyUI_XLWEB</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="dark-theme">
    <div class="container">
        <header class="header">
            <div class="header-top">
                <h1 data-i18n="title">ComfyUI_XLWEB</h1>
                <button class="settings-btn" id="settings-btn" onclick="openSettings()">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
            <p class="subtitle" data-i18n="pageDescription">探索创意无限的AI工作流</p>
            <div class="search-container">
                <input type="text" id="search-input" data-i18n-placeholder="search.placeholder" placeholder="搜索工作流..." class="search-input">
                <i class="fas fa-search search-icon"></i>
            </div>
        </header>

        <main class="main">
            <div class="workflows-grid" id="workflows-container">
                <!-- 工作流卡片将在这里动态生成 -->
            </div>
            
            <div class="empty-state" id="empty-state" style="display: none;">
                <i class="fas fa-folder-open"></i>
                <h3 data-i18n="workflow.noWorkflows">暂无工作流</h3>
                <p data-i18n="workflow.addWorkflowHint">请在 workflow 目录中添加工作流文件夹</p>
            </div>
        </main>

        <footer class="footer">
            <p>
                <a href="https://github.com/853587221/ComfyUI_XLweb" target="_blank" class="github-link">
                    <i class="fab fa-github"></i>
                </a>
                <span class="license">Apache-2.0 许可证</span>
            </p>
        </footer>
    </div>

    <!-- 工作流详情模态框 -->
    <div class="modal" id="workflow-modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="modal-image-container">
                    <img id="modal-image" src="" alt="">
                </div>
                <div class="modal-info">
                    <h2 id="modal-title"></h2>
                    <p id="modal-description"></p>
                    <div class="modal-actions">
                        <button class="btn btn-primary" onclick="applyWorkflow()">
                            <i class="fas fa-play"></i> <span data-i18n="workflow.apply">应用工作流</span>
                        </button>
                        <button class="btn btn-primary" onclick="downloadWorkflow()">
                            <i class="fas fa-download"></i> <span data-i18n="workflow.download">下载工作流</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 设置模态框 -->
    <div class="settings-modal" id="settings-modal">
        <div class="settings-overlay" onclick="closeSettings()"></div>
        <div class="settings-content">
            <div class="settings-header">
                <h3><i class="fas fa-cog"></i> <span data-i18n="settings.title">系统设置</span></h3>
                <button class="close-btn" onclick="closeSettings()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="settings-body">
                <!-- 服务器设置 -->
                <div class="setting-group">
                    <h4><i class="fas fa-server"></i> <span data-i18n="settings.server.title">服务器设置</span></h4>
                    <div class="setting-item">
                        <label for="server-ip" data-i18n="settings.server.ipLabel">ComfyUI 服务器 IP 地址</label>
                        <div style="display: flex; gap: 8px;">
                            <input type="text" id="server-ip" value="localhost:8188" data-i18n-placeholder="settings.server.ipPlaceholder" placeholder="支持多种格式: localhost:8188 或 http://192.168.1.100:8188 或 https://example.com/ 或 [::1]:8188 或 2001:db8::1" style="flex: 1;">
                            <button type="button" onclick="testServerConnection()" style="padding: 12px 16px; background: #ffd700; color: #1a1a2e; border: none; border-radius: 8px; cursor: pointer; font-size: 0.875rem; white-space: nowrap;">
                                <i class="fas fa-plug"></i> <span data-i18n="settings.server.testConnection">测试连接</span>
                            </button>
                        </div>
                        <small data-i18n="settings.server.serverAddressSupport">服务器地址支持IPv6和域名！点击"测试连接"验证，一次设置永久生效。</small>
                    </div>
                </div>

                <!-- 文件上传设置 -->
                <div class="setting-group">
                    <h4><i class="fas fa-upload"></i> <span data-i18n="settings.upload.title">文件上传限制</span></h4>
                    <div class="setting-item">
                        <label for="image-size-limit" data-i18n="settings.upload.imageLabel">图像文件大小限制 (MB)</label>
                        <input type="number" id="image-size-limit" value="10" min="1" max="100" step="1">
                        <small data-i18n="settings.upload.imageHint">单个图像文件的最大大小，单位：MB</small>
                    </div>
                    <div class="setting-item">
                        <label for="video-size-limit" data-i18n="settings.upload.videoLabel">视频文件大小限制 (MB)</label>
                        <input type="number" id="video-size-limit" value="100" min="1" max="1000" step="1">
                        <small data-i18n="settings.upload.videoHint">单个视频文件的最大大小，单位：MB</small>
                    </div>
                    <div class="setting-item">
                        <label for="audio-size-limit" data-i18n="settings.upload.audioLabel">音频文件大小限制 (MB)</label>
                        <input type="number" id="audio-size-limit" value="50" min="1" max="500" step="1">
                        <small data-i18n="settings.upload.audioHint">单个音频文件的最大大小，单位：MB</small>
                    </div>
                </div>

                <!-- 主题设置 -->
                <div class="setting-group">
                    <h4><i class="fas fa-palette"></i> <span data-i18n="settings.theme.title">主题设置</span></h4>
                    <div class="setting-item">
                        <label for="default-theme" data-i18n="settings.theme.defaultLabel">默认主题</label>
                        <select id="default-theme">
                            <option value="dark" data-i18n="settings.theme.darkTheme">暗色主题</option>
                            <option value="light" data-i18n="settings.theme.lightTheme">亮色主题</option>
                        </select>
                        <small data-i18n="settings.theme.defaultHint">选择页面加载时的默认主题风格</small>
                    </div>
                    <div class="setting-item">
                        <label data-i18n="settings.theme.currentLabel">当前主题</label>
                        <div class="theme-switcher">
                            <button class="theme-btn active" id="dark-theme-btn" onclick="switchTheme('dark')">
                                <i class="fas fa-moon"></i> <span data-i18n="settings.theme.dark">暗色</span>
                            </button>
                            <button class="theme-btn" id="light-theme-btn" onclick="switchTheme('light')">
                                <i class="fas fa-sun"></i> <span data-i18n="settings.theme.light">亮色</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 语言设置 -->
                <div class="setting-group">
                    <h4><i class="fas fa-language"></i> <span data-i18n="settings.language.title">语言设置</span></h4>
                    <div class="setting-item">
                        <label for="language-select" data-i18n="settings.language.label">界面语言</label>
                        <select id="language-select">
                            <option value="auto" data-i18n="settings.language.auto">跟随系统语言</option>
                            <option value="zh-CN">简体中文</option>
                            <option value="zh-TW">繁體中文</option>
                            <option value="en">英文 (English)</option>
                            <option value="ja">日文 (日本語)</option>
                            <option value="ko">韩文 (한국어)</option>
                            <option value="fr">法语 (Français)</option>
                            <option value="de">德语 (Deutsch)</option>
                            <option value="ar">阿拉伯文 (العربية)</option>
                            <option value="ru">俄语 (Русский)</option>
                            <option value="hi">印度语 (हिन्दी)</option>
                            <option value="es">西班牙语 (Español)</option>
                        </select>
                        <small data-i18n="settings.language.hint">选择界面显示语言，重启后生效</small>
                    </div>
                </div>
            </div>
            
            <div class="settings-footer">
                <button class="settings-save-btn" onclick="saveSettings()">
                    <i class="fas fa-save"></i> <span data-i18n="settings.buttons.save">保存设置</span>
                </button>
                <button class="settings-reset-btn" onclick="resetSettings()">
                    <i class="fas fa-undo"></i> <span data-i18n="settings.buttons.reset">重置默认</span>
                </button>
                <button class="settings-cancel-btn" onclick="closeSettings()">
                    <i class="fas fa-times"></i> <span data-i18n="settings.buttons.cancel">取消</span>
                </button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>